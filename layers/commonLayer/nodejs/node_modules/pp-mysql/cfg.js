module.exports = (() => {
    // "mysql://root@host/db?opt=val"
    // Amason RDS: see https://github.com/mysqljs/mysql#ssl-options for
    // connection pooling info: https://github.com/mysqljs/mysql#pooling-connections

    let url = new URL(process.env.MYSQLCFG || "mysql://root@mysql-local/v201-debug-mock");

    const CFG = {
        host: url.hostname,
        ...(url.port ? { port: url.port } : null),
        ...(url.username ? { user: url.username } : null),
        ...(url.password ? { password: url.password } : null),
        database: String(url.pathname).split("/", 2)[1],
        connectionLimit: 10,
        supportBigNumbers: true,
        ...Object.fromEntries(url.searchParams), // allow options from url to override defaults
    };

    return CFG;
})();
