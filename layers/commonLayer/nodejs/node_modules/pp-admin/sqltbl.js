const mysql_client = require('pp-mysql/client');
const { isString } = require('./model/model');

class SqlTbl {
    static async exec(sql) {
        if (!isString(sql)) throw new Error(`Parameter 'sql' must be string`);
        return { body: await mysql_client.$trx(async (conn) => {
            await conn.$exe(`START TRANSACTION`);
            const r = await conn.$exe(sql);
            await conn.$exe(`ROLLBACK`);
            return r;
        }) };
    };
}

module.exports = { SqlTbl };
