const { Q } = require('pp-mysql/client').shorthands();
const { SEARCH, FIELD, Model } = require('./model');

/// Merchant product base data
class ProductBase extends Model {

    static table = 'merchant_product';///< DB table

    /// API field => DB field
    static api2db = {
        [this.ID]: {// Integer ID of merchant product
            [FIELD.DBFIELD]: '_rowid',
        },
        [this.SID]: {// String ID of merchant product
            [FIELD.DBFIELD]: 'productID',
            [FIELD.READONLY]: true,
        },
        'name': {},// Name of product
        'image_url': {// Product image URL
            [FIELD.DBFIELD]: 'imageURL',
        },
        'price_total': {// Total price with taxes
            [FIELD.DBFIELD]: 'totalPrice',
            [FIELD.MODE]: FIELD.MODE_PATCH,
            [FIELD.SELECT]: `${Q(this.table)}.${Q('totalPrice')}`,// pounds
        },
        'price_wotax': {// Price without tax
            [FIELD.DBFIELD]: 'priceSansTax',
            [FIELD.MODE]: FIELD.MODE_PATCH,
            [FIELD.SELECT]: `${Q(this.table)}.${Q('priceSansTax')}`,// pounds
        },
        'tax_percent': {// Tax percent
            [FIELD.DBFIELD]: 'taxPercent',
        },
        'group_sid': {// Product group String ID
            [FIELD.DBFIELD]: 'productGroupID',
        },
        'index': {},// Index for sort
    };

    /// Search parameters
    static search = {
        [this.SID]: {// String ID of merchant product
            [SEARCH.WEQ]: 200,// Weight of search word (EQ)ual field
            [SEARCH.WIEQ]: 100,// Weight of search word (I)ndepend case (EQ)ual field
            [SEARCH.WHAS]: 50,// Weight of field (HAS) search word inside
            [SEARCH.WIHAS]: 50,// Weight of field (I)ndepend case (HAS) search word inside
        },
        'name': {// Name of merchant product
            [SEARCH.WEQ]: 200,// Weight of search word (EQ)ual field
            [SEARCH.WIEQ]: 100,// Weight of search word (I)ndepend case (EQ)ual field
            [SEARCH.WHAS]: 50,// Weight of field (HAS) search word inside
            [SEARCH.WIHAS]: 50,// Weight of field (I)ndepend case (HAS) search word inside
        },
    };
}

module.exports = { ProductBase };
